<!DOCTYPE html>
<html>
<head>
    <title>Raspberry Pi Access Point Configuration System</title>
</head>
<body>
    <h1>Raspberry Pi Access Point Configuration System</h1>

    <p>This system provides a way to reset and reconfigure a Raspberry Pi's WiFi settings using a physical button. When the button is pressed for 10 seconds, the system creates a temporary WiFi access point named "PiConfigWiFi". Users can then connect to this access point and visit http://192.168.4.1 to access a web interface where they can configure the Raspberry Pi to connect to their local WiFi network. Once configured, the system switches to the new network and provides an admin interface at http://[hostname].local for monitoring system status.</p>

    <h2>System Components</h2>
    <ol>
        <li><code>access_point.py</code>: Main script that sets up the WiFi access point</li>
        <li><code>web_config.py</code>: Web server that provides the configuration interface</li>
        <li><code>config.html</code>: Web interface template for WiFi configuration</li>
        <li><code>admin/admin_server.py</code>: Admin interface server that runs after configuration</li>
        <li><code>admin/templates/admin.html</code>: Admin panel interface template</li>
    </ol>

    <h2>How It Works</h2>
    
    <h3>1. Initial Setup</h3>
    <ul>
        <li>Run the main script: <code>sudo python3 access_point.py</code></li>
        <li>The script monitors GPIO Pin 2 for button press</li>
        <li>Hold the button for 10 seconds to initiate setup</li>
    </ul>

    <h3>2. Access Point Creation</h3>
    <p>When triggered, <code>access_point.py</code>:</p>
    <ul>
        <li>Sets up a WiFi access point named "PiConfigWiFi"</li>
        <li>Configures the network with IP 192.168.4.1</li>
        <li>Automatically launches the web configuration server</li>
    </ul>

    <h3>3. Web Configuration</h3>
    <ul>
        <li>Connect to the "PiConfigWiFi" network</li>
        <li>Navigate to http://192.168.4.1 in your web browser</li>
        <li>The configuration page provides two options:
            <ul>
                <li>Manually enter network credentials</li>
                <li>Scan for available networks and select one</li>
            </ul>
        </li>
    </ul>

    <h2>Requirements</h2>
    <ul>
        <li>Raspberry Pi with WiFi capability</li>
        <li>Python 3.x</li>
        <li>Required Python packages:
            <pre>
sudo pip3 install flask
sudo pip3 install RPi.GPIO
sudo pip3 install psutil</pre>
        </li>
        <li>Required System Packages:
            <pre>
sudo apt-get update
sudo apt-get install hostapd dnsmasq avahi-daemon</pre>
        </li>
    </ul>

    <h2>System Services</h2>
    <h3>Admin Server Service</h3>
    <p>The system creates a systemd service for the admin interface:</p>
    <pre>
    # Service file location
    /etc/systemd/system/pi-admin-panel.service

    # Service management commands
    sudo systemctl status pi-admin-panel    # Check service status
    sudo systemctl start pi-admin-panel     # Start service
    sudo systemctl stop pi-admin-panel      # Stop service
    sudo systemctl restart pi-admin-panel   # Restart service
    sudo systemctl enable pi-admin-panel    # Enable on boot
    sudo journalctl -u pi-admin-panel       # View service logs
    </pre>

    <h2>Debugging and Testing</h2>

    <h3>Debug Mode</h3>
    <ol>
        <li>Enable Flask Debug Mode:
            <pre>
    # In web_config.py, modify the app.run() line:
    if __name__ == '__main__':
        app.run(host='192.168.4.1', port=80, debug=True)</pre>
        </li>
        <li>Enable Verbose Logging:
            <pre>
    # Add to top of access_point.py
    import logging
    logging.basicConfig(
        level=logging.DEBUG,
        format='%(asctime)s - %(levelname)s - %(message)s',
        filename='access_point.log')</pre>
        </li>
    </ol>

    <h3>Testing Steps</h3>
    <ol>
        <li>Test Access Point Setup:
            <pre>
    # Run with debug output
    sudo python3 -v access_point.py

    # Monitor system logs
    sudo tail -f /var/log/syslog | grep -E "hostapd|dnsmasq"

    # Check network interface
    iwconfig wlan0</pre>
        </li>
    </ol>

    <h3>Logging Locations</h3>
    <ul>
        <li><code>/var/log/syslog</code> - System logs</li>
        <li><code>/var/log/hostapd.log</code> - Access point logs</li>
        <li><code>access_point.log</code> - Application logs</li>
        <li>Flask debug output in terminal</li>
    </ul>

    <h2>Known Limitations</h2>
    <ul>
        <li>Single-band WiFi support only</li>
        <li>No HTTPS support</li>
        <li>Basic authentication</li>
        <li>Limited error recovery</li>
        <li>Requires manual initiation</li>
    </ul>

    <h2>Future Improvements</h2>
    <ul>
        <li>HTTPS support</li>
        <li>Improved security</li>
        <li>Automatic network detection</li>
        <li>Status LED indicators</li>
        <li>Connection quality monitoring</li>
        <li>Automatic fallback mechanism</li>
    </ul>

    <h2>Testing Tools</h2>
    <ul>
        <li><code>curl</code> - Test web endpoints</li>
        <li><code>tcpdump</code> - Monitor network traffic</li>
        <li><code>wireshark</code> - Detailed packet analysis</li>
        <li><code>htop</code> - Monitor system resources</li>
    </ul>

    <h2>Common Debug Issues</h2>
    <ol>
        <li>Access Point Not Starting:
            <pre>
    # Check hostapd status
    sudo systemctl status hostapd

    # Test hostapd configuration
    sudo hostapd -dd /etc/hostapd/hostapd.conf</pre>
        </li>
        <li>Web Server Issues:
            <pre>
    # Check if port 80 is available
    sudo netstat -tulpn | grep :80

    # Test Flask server response
    curl -v http://192.168.4.1</pre>
        </li>
        <li>Network Scanning Problems:
            <pre>
    # Manual network scan
    sudo iwlist wlan0 scan

    # Check wireless interface status
    rfkill list all</pre>
        </li>
    </ol>

    <h2>Debug Environment Variables</h2>
    <pre>
    export FLASK_ENV=development
    export FLASK_DEBUG=1
    export PYTHONVERBOSE=1</pre>

    <h2>System Workflow</h2>
    
    <h3>System Workflow</h3>
    <ol>
        <li>Initial Configuration:
            <ul>
                <li>User presses button → access_point.py creates AP</li>
                <li>access_point.py → launches web_config.py</li>
                <li>User connects to AP → accesses web interface</li>
                <li>User submits credentials → web_config.py configures WiFi</li>
            </ul>
        </li>
        <li>Admin Interface:
            <ul>
                <li>System connects to configured WiFi</li>
                <li>web_config.py creates and starts pi-admin-panel service</li>
                <li>Admin interface accessible at http://raspberrypi.local</li>
                <li>Interface shows system status and metrics</li>
            </ul>
        </li>
    </ol>

    <h2>Admin Interface Features</h2>
    <ul>
        <li>Real-time system monitoring:
            <ul>
                <li>CPU usage and temperature</li>
                <li>Memory utilization</li>
                <li>Disk space information</li>
                <li>Network status and WiFi details</li>
                <li>System uptime</li>
            </ul>
        </li>
        <li>Responsive design for mobile and desktop</li>
        <li>Auto-refreshing metrics (every 5 seconds)</li>
        <li>Visual indicators for system health</li>
    </ul>

    <h2>Configuration Files</h2>
    <ul>
        <li><code>/etc/dhcpcd.conf</code> - Network interface configuration</li>
        <li><code>/etc/hostapd/hostapd.conf</code> - Access point configuration</li>
        <li><code>/etc/dnsmasq.conf</code> - DHCP server configuration</li>
        <li><code>/etc/wpa_supplicant/wpa_supplicant.conf</code> - WiFi client configuration</li>
    </ul>

    <h2>Backup and Recovery</h2>
    <p>The system automatically:</p>
    <ul>
        <li>Backs up existing network configuration</li>
        <li>Restores configuration on cleanup</li>
        <li>Handles unexpected shutdowns</li>
        <li>Maintains original network settings</li>
    </ul>

    <h2>Contributing</h2>
    <ol>
        <li>Fork the repository</li>
        <li>Create feature branch</li>
        <li>Submit pull request</li>
        <li>Include tests and documentation</li>
    </ol>

    <h2>License</h2>
    <p>[Your License Information]</p>

    <h2>Authors</h2>
    <p>Created with assistance from Cursor AI, powered by Anthropic's Claude 3.5 Sonnet.</p>

    <h2>Acknowledgments</h2>
    <ul>
        <li>Cursor AI - AI-powered development environment</li>
        <li>Anthropic's Claude 3.5 Sonnet - Large Language Model</li>
        <li>RPi.GPIO documentation</li>
        <li>Flask documentation</li>
        <li>Raspberry Pi networking guides</li>
    </ul>

    <h2>Directory Structure</h2>
    <pre>
    project_root/
    ├── access_point.py
    ├── web_config.py
    ├── templates/
    │   └── config.html
    ├── admin/
    │   ├── admin_server.py
    │   └── templates/
    │       └── admin.html
    └── README.html
    </pre>

    <h3>Admin Server Debugging</h3>
    <pre>
    # Check admin server status
    sudo systemctl status pi-admin-panel

    # View admin server logs
    sudo journalctl -u pi-admin-panel -f

    # Test admin interface
    curl -v http://raspberrypi.local

    # Check avahi-daemon status
    sudo systemctl status avahi-daemon
    </pre>

</body>
</html>
